# A method to generate large mass of capture baits for targeted sequencing

This repository contains scripts used to analyze data and to make figures reported in Sundararaman et al, Nucleic Acid Research (2023). 

This article reports Circular Nuclecid acid Enrichment Reagent synthesis (CNERs) method for making DNA probes for targeted sequencing by hybridization capture. 
Using CNERs method, a horse SNP panel was generated to sequence and genotype ancient horses.  
Horse SNP panel contains 23,771 SNPs identified from WGS of ancient horses reported by Vershinina A et al (2021) and other previous studies. 
Using CNERs, we genotyped and recapitulated the ancient horse population structure, using a fraction of resources than previous studies. 

## Data analyses
* horse_fq2counts.sh:
  
  This bash scripts analyzes paired-end sequencing data from mutiple samples and generates both individuall and overall sample summary. 
  Takes raw fastq files, trims adapters and merges overlapping paired-end reads using SeqPrep2 (https://github.com/jeizenga/SeqPrep2). 
  Removes low complexity reads from merged and unmerged reads using prinseq (https://github.com/uwb-linux/prinseq).
  Maps merged reads as SE and unmereged read-pairs as PE mode using bwa aln (http://bio-bwa.sourceforge.net/bwa.shtml).
  Bam files merged, sorted and indexed using samtools (http://www.htslib.org/doc/samtools.html).
  Duplicates marked and removed using Picard MarkDuplicates (https://broadinstitute.github.io/picard/).
  Individual SNP coverage depth and coverage around the SNP region are collected using bedtools (https://bedtools.readthedocs.io/en/latest/index.html).
  Coverage across GC bins, Coverage with various CNERs length, coverage around SNP region and target SNP coverage are plotted using below custom scripts. 
  
* gc_cover_plot.py: 

  Takes coverage and GC content information for each CNERs bait regions from 'PER_TARGET_COVERAGE' file generated by Picard CollectHsMetrics. 
  Parses coverage for each GC bin and plots them in primary Y-axis. 
  Histogram of GC content of all target CNERs regions plotted in seconday Y-axis. 
 
* cner_len_SNPdepth.py:
 
  Takes coverage depth for all targeted 23,771 SNPs in the panel generated using bedtools multicov, 
  Parse them to coverage for 50bp, 80bp and 100bp long CNERs and plot as overlapping normalized histogram from each CNERs length. 
  Mann-Whitney U test P values from all pairwise comparisons are also included in the plot.  
 
* plot_SNP_100updown_coverage.py:

  Takes coverage depth form 100bp up and downstream of SNP site for all targeted 23,771 SNPs with non-zero coverage in the panel generated using bedtools coverage, 
  Plots first quartile, median and third quartile coverage at each position. 

* targetSNP_covDepth_PCTplot.py:

  Takes coverage depth for all targeted 23,771 SNPs in the panel generated using bedtools multicov,
  Plots percent target SNPs at each coverage and plots cumulative coverage of all targeted SNPs. Cumulative coverage plot can be used to visualize percent target     SNPs with less or more than a given coverage.  
 

